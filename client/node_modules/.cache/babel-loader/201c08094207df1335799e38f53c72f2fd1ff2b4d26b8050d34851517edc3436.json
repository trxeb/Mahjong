{"ast":null,"code":"var _jsxFileName = \"/Users/angyi/Documents/GitHub/Mahjong/client/src/pages/Home.js\",\n  _s = $RefreshSig$();\n// client/src/pages/Home.js\nimport React, { useState, useEffect } from 'react';\nimport { Container, Button } from 'reactstrap';\nimport { auth, db } from '../firebase-config'; // Import auth and db\nimport { signOut, onAuthStateChanged } from 'firebase/auth';\nimport { doc, getDoc } from 'firebase/firestore'; // Import Firestore functions\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Home({\n  onNavigate\n}) {\n  _s();\n  const [userEmail, setUserEmail] = useState('Guest');\n  const [customUserId, setCustomUserId] = useState(''); // State for custom user ID\n\n  // Listen for auth state changes and fetch user data from Firestore\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async user => {\n      if (user) {\n        // If user is logged in, try to fetch their data from Firestore\n        const userDocRef = doc(db, \"users\", user.uid);\n        const userDocSnap = await getDoc(userDocRef);\n        if (userDocSnap.exists()) {\n          const userData = userDocSnap.data();\n          setUserEmail(user.email || 'User');\n          setCustomUserId(userData.customUserId || '');\n        } else {\n          // User exists in Auth but not in Firestore 'users' collection\n          setUserEmail(user.email || 'User');\n          setCustomUserId('');\n        }\n      } else {\n        // User logged out\n        setUserEmail('Guest'); // Reset userEmail to 'Guest'\n        setCustomUserId('');\n        onNavigate('login'); // Redirect to login if logged out\n      }\n    });\n\n    // Clean up subscription on component unmount\n    return () => unsubscribe();\n  }, [onNavigate]);\n  const handleLogout = async () => {\n    try {\n      await signOut(auth);\n      console.log('User logged out successfully');\n    } catch (error) {\n      console.error('Error logging out:', error);\n    }\n  };\n\n  // Determine the name to display for the greeting\n  const greetingName = customUserId || userEmail || 'there';\n  return /*#__PURE__*/_jsxDEV(Container, {\n    fluid: true,\n    className: \"d-flex justify-content-center align-items-center min-vh-100 p-3\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center p-4 p-md-5 bg-white rounded-4 shadow-lg-custom\",\n      style: {\n        maxWidth: '600px',\n        width: '100%'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"display-4 fw-bolder text-custom-dark mb-3\",\n        children: \"Welcome!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"lead text-muted\",\n        children: [\"Hello, \", greetingName, \"!\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 17\n      }, this), customUserId && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"lead text-muted\",\n        children: [\"Your custom ID: **\", customUserId, \"**\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 34\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-4\",\n        children: \"This is your home page. You are successfully logged in.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        color: \"danger\",\n        onClick: handleLogout,\n        className: \"mt-4 rounded-pill\",\n        children: \"Logout\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 54,\n    columnNumber: 9\n  }, this);\n}\n_s(Home, \"9o5bhnHmndxwafR3Smq/7Wle1cw=\");\n_c = Home;\nvar _c;\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"names":["React","useState","useEffect","Container","Button","auth","db","signOut","onAuthStateChanged","doc","getDoc","jsxDEV","_jsxDEV","Home","onNavigate","_s","userEmail","setUserEmail","customUserId","setCustomUserId","unsubscribe","user","userDocRef","uid","userDocSnap","exists","userData","data","email","handleLogout","console","log","error","greetingName","fluid","className","children","style","maxWidth","width","fileName","_jsxFileName","lineNumber","columnNumber","color","onClick","_c","$RefreshReg$"],"sources":["/Users/angyi/Documents/GitHub/Mahjong/client/src/pages/Home.js"],"sourcesContent":["// client/src/pages/Home.js\nimport React, { useState, useEffect } from 'react';\nimport { Container, Button } from 'reactstrap';\nimport { auth, db } from '../firebase-config'; // Import auth and db\nimport { signOut, onAuthStateChanged } from 'firebase/auth';\nimport { doc, getDoc } from 'firebase/firestore'; // Import Firestore functions\n\nexport default function Home({ onNavigate }) {\n    const [userEmail, setUserEmail] = useState('Guest'); \n    const [customUserId, setCustomUserId] = useState(''); // State for custom user ID\n\n    // Listen for auth state changes and fetch user data from Firestore\n    useEffect(() => {\n        const unsubscribe = onAuthStateChanged(auth, async (user) => {\n            if (user) {\n                // If user is logged in, try to fetch their data from Firestore\n                const userDocRef = doc(db, \"users\", user.uid);\n                const userDocSnap = await getDoc(userDocRef);\n\n                if (userDocSnap.exists()) {\n                    const userData = userDocSnap.data();\n                    setUserEmail(user.email || 'User'); \n                    setCustomUserId(userData.customUserId || '');\n                } else {\n                    // User exists in Auth but not in Firestore 'users' collection\n                    setUserEmail(user.email || 'User');\n                    setCustomUserId('');\n                }\n            } else {\n                // User logged out\n                setUserEmail('Guest'); // Reset userEmail to 'Guest'\n                setCustomUserId('');\n                onNavigate('login'); // Redirect to login if logged out\n            }\n        });\n\n        // Clean up subscription on component unmount\n        return () => unsubscribe();\n    }, [onNavigate]); \n\n    const handleLogout = async () => {\n        try {\n            await signOut(auth);\n            console.log('User logged out successfully');\n        } catch (error) {\n            console.error('Error logging out:', error);\n        }\n    };\n\n    // Determine the name to display for the greeting\n    const greetingName = customUserId || userEmail || 'there';\n\n    return (\n        <Container fluid className=\"d-flex justify-content-center align-items-center min-vh-100 p-3\">\n            <div className=\"text-center p-4 p-md-5 bg-white rounded-4 shadow-lg-custom\" style={{ maxWidth: '600px', width: '100%' }}>\n                <h1 className=\"display-4 fw-bolder text-custom-dark mb-3\">Welcome!</h1>\n                {/* Display the greeting using customUserId or userEmail as fallback */}\n                <p className=\"lead text-muted\">Hello, {greetingName}!</p>\n                {customUserId && <p className=\"lead text-muted\">Your custom ID: **{customUserId}**</p>}\n                \n                <p className=\"mt-4\">This is your home page. You are successfully logged in.</p>\n                \n                <Button color=\"danger\" onClick={handleLogout} className=\"mt-4 rounded-pill\">\n                    Logout\n                </Button>\n            </div>\n        </Container>\n    );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}